# 2.5 Commandes essentielles pour le quotidien

← [Section précédente](2.4-conda-librairies.md) | [Section suivante →](3.1-vscode-interface.md)

---

## Inspecter vos environnements

Ces commandes vous permettent de savoir **où vous êtes** et **ce que vous avez** installé :

| Commande | Résultat | Quand l'utiliser |
|--------------------|--------------------|--------------------------------|
| `conda env list` | Liste tous vos environnements | Voir quels projets existent |
| `conda list` | Librairies dans l'environnement actif | Vérifier versions installées |
| `conda list gdal` | Info sur une librairie spécifique | Vérifier si GDAL est installé et sa version |

**Exemple pratique** :

``` bash
# Vérifier quel environnement est actif
conda env list
# → Celui avec * est actif

# Lister toutes les librairies installées
conda list

# Chercher une librairie spécifique
conda list gdal
# → gdal  3.8.0  py311h1234567_0  conda-forge
```

---

## Nettoyer l'espace disque

**Problème courant** : Le cache Conda grandit rapidement (+ 5 GB après quelques mois d'utilisation). Les environnements de test s'accumulent et remplissent votre disque.

| Commande | Effet | Quand l'utiliser |
|--------------------|-------------------|---------------------------------|
| `conda clean --all --dry-run` | Voir ce qui sera supprimé (sans supprimer) | Avant de nettoyer |
| `conda clean --all` | Supprimer cache et librairies inutilisées | Une fois par mois |
| `conda remove -n old-env --all` | Supprimer complètement un environnement | Projet terminé |

**Exemple pratique** :

``` bash
# Voir combien d'espace vous pouvez récupérer
conda clean --all --dry-run

# Résultat typique :
# Will remove 47 tarball(s), 8.5 GB
# Will remove 12 librairie(s), 2.1 GB

# Si > 5 GB, nettoyer :
conda clean --all

# Supprimer un vieil environnement de test
conda remove -n test-env --all
```

---

## Exporter pour reproductibilité

**Règle d'or** : Toujours exporter `environment.yml` avant de committer sur Git.

| Commande | Résultat | Avantage |
|------------------------|------------------------|------------------------|
| `conda env export > environment.yml` | Fichier avec **toutes** les dépendances (100+ lignes) | Reproductibilité exacte |
| `conda env export --from-history > environment.yml` | Fichier avec seulement librairies **explicitement installées** (10-15 lignes) | Lisible et maintenable |

**Recommandation** : Utilisez `--from-history` pour un fichier propre et lisible.

**Exemple pratique** :

``` bash
# Activer votre environnement
conda activate geo-env

# Exporter (version lisible recommandée)
conda env export --from-history > environment.yml

# Résultat : fichier concis
# name: geo-env
# channels:
#   - conda-forge
# dependencies:
#   - python=3.11
#   - geopandas
#   - gdal
#   - rasterio
#   - jupyter

# Committer ce fichier sur Git
git add environment.yml
git commit -m "Ajouter environment.yml pour reproductibilité"
```

---

## Erreurs courantes à éviter

| Mauvaise pratique | Bonne pratique |
|---------------------------------------|---------------------------------|
| `conda install geopandas` dans `(base)` | Créer un nouvel environnement dédié |
| Supprimer le dossier `miniforge3/` manuellement | Utiliser `conda remove -n env --all` |
| Mélanger `pip install` et `conda install` sans ordre | Toujours `conda` en premier, `pip` ensuite si nécessaire |

**Pourquoi ne jamais toucher à `(base)` ?** Si vous cassez l'environnement de base, vous cassez Conda lui-même et devrez réinstaller Miniforge.

---

← [Section précédente](2.4-conda-librairies.md) | [Section suivante →](3.1-vscode-interface.md)
